from argh import arg, wrap_errors
import socket
from . import util

@arg('client_pub_key', help='public key of the client')
@arg('client_ip', help='client tunnel ip')
@wrap_errors([socket.error, IOError])
def addclient(client_pub_key, client_ip):
    'add a client ip reservation'
    util.addremotesubnet(client_ip + "/32", client_pub_key) # add client ip to ygg running config
    util.gateway_provision()

@wrap_errors([socket.error, IOError])
def server():
    print("Starting gateway server...")

cmd = [addclient, server]
